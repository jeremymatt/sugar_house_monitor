# Example Tank Pi env file
# Copy to ../tank_pi.env on the Pi and adjust paths/URLs/keys as needed.

API_BASE_URL=https://example.com/sugar_house_monitor/api
API_KEY=REPLACE_ME_WITH_GENERATED_KEY
DB_PATH=data/tank_pi.db
DB_RETENTION_DAYS=365
DB_PRUNE_INTERVAL_SECONDS=604800
EVAPORATOR_DB_PATH=data/evaporator.db
STATUS_JSON_PATH=web/data/status.json
WEB_ROOT=web
LOCAL_HTTP_HOST=0.0.0.0
LOCAL_HTTP_PORT=8080
UPLOAD_BATCH_SIZE=4
UPLOAD_INTERVAL_SECONDS=60
PUMP_UPLOAD_BATCH_SIZE=1
PUMP_UPLOAD_INTERVAL_SECONDS=60
VACUUM_UPLOAD_BATCH_SIZE=8
VACUUM_UPLOAD_INTERVAL_SECONDS=30
HANDSHAKE_INTERVAL_SECONDS=60
ERROR_UPLOAD_BATCH_SIZE=8
ERROR_UPLOAD_INTERVAL_SECONDS=30
UPLOAD_HEARTBEAT_SECONDS=120       
# Disk usage reporting for storage warning card
DISK_USAGE_PATH=~
# Sensor sampling
TANK_NUM_TO_AVERAGE=8              # number of ultrasonic readings to average per sample
TANK_MEAS_DELAY=0.25               # delay (sec) between ultrasonic readings when averaging
TANK_READINGS_PER_MIN=4            # how many averaged samples to take per minute

# Hampel filter for depth
TANK_FILTER_WINDOW=50              # points in Hampel window
TANK_FILTER_SIGMA=0.25             # n_sigma threshold for Hampel outlier detection

# Flow update cadence
TANK_RATE_UPDATE_SECONDS=15        # seconds between flow recalculations

# Adaptive trailing flow window settings
TANK_FLOW_WINDOW_MINUTES=6         # initial trailing window (minutes) for flow fit
TANK_HAMPEL_WINDOW=50              # Hampel window for flow calc (defaults to TANK_FILTER_WINDOW)
TANK_HAMPEL_SIGMA=0.25             # Hampel n_sigma for flow calc (defaults to TANK_FILTER_SIGMA)
TANK_ADAPT_SHORT_FLOW_WINDOW_MIN=3 # trailing window (minutes) used to steer adaptive window
TANK_ADAPT_NEG_WINDOW_MIN=15       # target window (minutes) when recent flows are all negative
TANK_ADAPT_POS_MAX_WINDOW_MIN=100  # maximum target window when filling
TANK_ADAPT_WINDOW_UPDATE_DELAY=2   # number of recent short-flow estimates to consider
TANK_ADAPT_STEP=0.1                # fraction to move window toward target each update
TANK_LOW_FLOW_THRESHOLD=20         # abs(gph) considered ~zero for expansion
TANK_LARGE_NEG_FLOW_GPH=100        # when flow < -threshold, block backward expansion past that point

# Debug / replay controls
DEBUG_TANK=false
DEBUG_RELEASER=false
DEBUG_LOOP_DATA=false
DEBUG_LOOP_GAP_SECONDS=10
SYNTHETIC_CLOCK_MULTIPLIER=2.0
DEBUG_SAMPLE_PROCESS_TIMING=false

# Debug datasets (CSV paths relative to repo root)
BROOKSIDE_CSV=real_data/brookside.csv
ROADSIDE_CSV=real_data/roadside.csv
PUMP_EVENTS_CSV=real_data/pump_times.csv
